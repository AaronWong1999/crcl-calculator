<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Circle (CRCL) ÊàòÁï•ÊäïËµÑÊ®°ÊãüÂô® v5.2</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: #050505;
            color: #e5e5e5;
        }

        .glass-card {
            background: rgba(18, 18, 18, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.03);
            border-radius: 16px;
        }

        .metric-card {
            background: linear-gradient(145deg, #121212 0%, #0a0a0a 100%);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 1.25rem;
        }

        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        th {
            background-color: #0f0f0f;
            color: #737373;
            font-weight: 600;
            text-align: right;
            padding: 14px 10px;
            border-bottom: 1px solid #1f1f1f;
            white-space: nowrap;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-size: 11px;
        }

        th:first-child { text-align: left; padding-left: 20px; }

        td {
            padding: 12px 10px;
            text-align: right;
            border-bottom: 1px solid #0f0f0f;
            font-variant-numeric: tabular-nums;
        }

        td:first-child { text-align: left; padding-left: 20px; color: #525252; font-weight: 500; }

        tr:hover { background-color: rgba(255, 255, 255, 0.01); }

        .executed-row { background-color: rgba(34, 197, 94, 0.05); }
        .executed-row td:first-child { color: #22c55e !important; }
        .pending-row { opacity: 0.8; }
        
        .active-row { 
            border-left: 3px solid #3b82f6; 
            background-color: rgba(59, 130, 246, 0.05); 
        }

        .text-value { color: #ffffff; font-weight: 600; font-family: 'SF Mono', ui-monospace, monospace; }
        .text-dim { color: #737373; }
        
        input {
            background: #121212;
            border: 1px solid #262626;
            color: #fff;
            padding: 6px 12px;
            border-radius: 6px;
            width: 120px;
            text-align: right;
            font-family: monospace;
            font-weight: bold;
        }
        
        input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
        }

        .tab-btn {
            padding: 8px 20px;
            border-radius: 8px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 600;
            font-size: 13px;
            color: #737373;
        }

        .tab-btn.active {
            background-color: #262626;
            color: #fff;
            box-shadow: 0 4px 12px rgba(0,0,0,0.5);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #050505; }
        ::-webkit-scrollbar-thumb { background: #1f1f1f; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #333; }

        .badge-green { background: rgba(34, 197, 94, 0.1); color: #4ade80; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: bold; }
        .badge-gray { background: rgba(115, 115, 115, 0.1); color: #a3a3a3; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: bold; }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-7xl mx-auto">
        <header class="flex flex-col md:flex-row justify-between items-start md:items-end mb-8 gap-4">
            <div>
                <div class="flex items-center gap-3 mb-2">
                    <div class="w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center font-bold text-white">C</div>
                    <h1 class="text-3xl font-black text-white tracking-tighter">CIRCLE <span class="text-blue-500">INVEST</span></h1>
                </div>
                <p class="text-neutral-500 text-sm font-medium">Strategic Investment Matrix ‚Ä¢ Valuation Targets: $500B & $750B</p>
            </div>
            
            <div class="flex flex-col gap-1 items-end">
                <span class="text-[10px] text-neutral-500 uppercase font-bold tracking-widest">ÂΩìÂâçÂ∏ÇÂú∫ÂèÇËÄÉ‰ª∑ (USD)</span>
                <div class="relative">
                    <input type="number" id="currentMarketPrice" value="65.20" step="0.01" class="text-xl w-32 pr-4 text-blue-400" onchange="recalc()">
                    <span class="absolute right-2 top-2 text-neutral-600 font-bold">$</span>
                </div>
            </div>
        </header>

        <!-- Portfolio Metrics Summary -->
        <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-8">
            <div class="metric-card">
                <div class="text-[10px] text-neutral-500 font-bold uppercase mb-2">Â∑≤Áî®Êú¨Èáë (Deployed)</div>
                <div class="text-2xl font-black text-amber-400" id="stat-deployed-capital">$0</div>
                <div class="text-xs text-neutral-400 mt-1" id="stat-total-cost">Invested</div>
            </div>
            <div class="metric-card">
                <div class="text-[10px] text-neutral-500 font-bold uppercase mb-2">ÂΩìÂâçÂ∑≤Êàê‰∫§ËÇ°Êï∞ (Executed)</div>
                <div class="text-2xl font-black text-white" id="stat-total-shares">0</div>
                <div class="text-xs text-neutral-400 mt-1">Shares</div>
            </div>
            <div class="metric-card">
                <div class="text-[10px] text-neutral-500 font-bold uppercase mb-2">ÂΩìÂâçÊåÅ‰ªìÂùá‰ª∑ (Avg Price)</div>
                <div class="text-2xl font-black text-blue-400" id="stat-avg-price">$0.00</div>
                <div class="text-xs text-neutral-400 mt-1" id="stat-pnl">Break-even: $0</div>
            </div>
            <div class="metric-card border-l-4 border-l-blue-600">
                <div class="text-[10px] text-neutral-500 font-bold uppercase mb-2">500B ÊåÅ‰ªì‰ª∑ÂÄº (Est. Value)</div>
                <div class="text-2xl font-black text-emerald-400" id="stat-val-500b">$0M</div>
                <div class="text-xs text-emerald-600 font-bold mt-1" id="stat-roi-500b">ROI: +0%</div>
            </div>
            <div class="metric-card border-l-4 border-l-purple-600">
                <div class="text-[10px] text-neutral-500 font-bold uppercase mb-2">750B ÊåÅ‰ªì‰ª∑ÂÄº (Est. Value)</div>
                <div class="text-2xl font-black text-purple-400" id="stat-val-750b">$0M</div>
                <div class="text-xs text-purple-600 font-bold mt-1" id="stat-roi-750b">ROI: +0%</div>
            </div>
        </div>

        <!-- Configuration -->
        <div class="glass-card p-6 mb-8 flex flex-wrap gap-8 items-center bg-neutral-900/20">
            <div class="flex flex-col gap-1">
                <span class="text-[10px] text-neutral-500 uppercase font-black tracking-widest">ÂàùÂßãÂ∫ï‰ªìËµÑÈáë ($)</span>
                <input type="number" id="baseInvest" value="1000000" class="w-32" onchange="recalc()">
            </div>
            <div class="flex flex-col gap-1">
                <span class="text-[10px] text-neutral-500 uppercase font-black tracking-widest">Ë°•‰ªìËΩÆÊ¨°ËµÑÈáë ($)</span>
                <input type="number" id="stepInvest" value="100000" class="w-32" onchange="recalc()">
            </div>
            <div class="flex flex-col gap-1">
                <span class="text-[10px] text-neutral-500 uppercase font-black tracking-widest">ÂØπÂ∫îÂΩìÂâçÂ∏ÇÂÄº (‰∫ø$)</span>
                <div class="flex items-center gap-2">
                    <input type="number" id="currentMarketCap" value="153.56" step="0.01" class="w-24" onchange="recalc()">
                </div>
            </div>
            <div class="flex flex-col gap-1 items-start">
                 <span class="text-[10px] text-neutral-500 uppercase font-black tracking-widest">Ëá™Âä®Ëé∑Âèñ‰ª∑Ê†º</span>
                 <button onclick="fetchPrice()" class="bg-blue-600 hover:bg-blue-500 text-white text-xs px-3 py-2 rounded font-bold transition-colors">
                    üîÑ Âà∑Êñ∞ / Ê®°Êãü
                 </button>
            </div>
            <div class="ml-auto flex gap-2 bg-black/40 p-1.5 rounded-xl border border-white/5">
                <button id="tab1" class="tab-btn active" onclick="switchTab(1)">ÊñπÊ°à A (7% Ë∑åÂπÖÊ≠•Ëøõ)</button>
                <button id="tab2" class="tab-btn" onclick="switchTab(2)">ÊñπÊ°à B (10% Ë∑åÂπÖÊ≠•Ëøõ)</button>
            </div>
        </div>

        <!-- Main Table Area -->
        <div class="glass-card overflow-hidden border border-white/5 shadow-2xl">
            <div class="p-5 border-b border-neutral-800 flex flex-col md:flex-row justify-between items-center gap-4 bg-neutral-900/40">
                <div>
                    <h3 id="tableTitle" class="text-lg font-bold text-white tracking-tight">ÊñπÊ°à A Ë°•‰ªìÊºîÂåñÁü©Èòµ</h3>
                    <p class="text-neutral-500 text-[10px] font-bold uppercase tracking-widest mt-0.5">Investment Path Evolution ‚Ä¢ Scenario A</p>
                </div>
                <div class="flex gap-4">
                    <div class="flex items-center gap-2">
                        <span class="w-3 h-3 rounded-full bg-emerald-500/20 border border-emerald-500"></span>
                        <span class="text-[10px] text-neutral-400 font-bold">Â∑≤Êàê‰∫§</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="w-3 h-3 rounded-full bg-blue-500/20 border border-blue-500"></span>
                        <span class="text-[10px] text-neutral-400 font-bold">ÂΩìÂâç‰ª∑Ê†ºÂå∫Èó¥</span>
                    </div>
                </div>
            </div>
            <div class="table-container">
                <table id="mainTable">
                    <thead>
                        <tr>
                            <th class="text-left">Ê°£‰Ωç n</th>
                            <th>ÊåÇÂçï‰ª∑Ê†º Pn</th>
                            <th>ÊåÇÂçïÊï∞Èáè Qn</th>
                            <th>Á¥ØËÆ°ÊäïËµÑÈáëÈ¢ù</th>
                            <th>Á¥ØËÆ°ËÇ°Êï∞</th>
                            <th>ÊåÅ‰ªìÂùá‰ª∑</th>
                            <th>Á¥ØËÆ°ÊàêÊú¨Â∏ÇÂÄº</th>
                            <th class="text-emerald-400">500B ‰ª∑ÂÄºÂõûÊä•</th>
                            <th class="text-purple-400">750B ‰ª∑ÂÄºÂõûÊä•</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <!-- Data will be injected here -->
                    </tbody>
                </table>
            </div>
        </div>

        <footer class="mt-8 text-neutral-600 text-[10px] flex justify-between items-center font-bold tracking-widest uppercase">
            <div>Strategic System v5.2 ‚Ä¢ Precision Modeling</div>
            <div class="flex gap-6">
                <span>Total Shares Ref: <span id="ref-shares" class="text-neutral-400">0</span></span>
                <span>Valuation Multiplier: <span id="ref-mult" class="text-neutral-400">0x</span></span>
            </div>
        </footer>
    </div>

    <script>
        let currentTab = 1;
        
        // Original Data from screenshots
        const dataA = [
            { n: "0 (Â∫ï‰ªì)", p: 65.20 },
            { n: "1", p: 65.20 },
            { n: "2", p: 60.89 },
            { n: "3", p: 56.84 },
            { n: "4", p: 53.09 },
            { n: "5", p: 49.59 },
            { n: "6", p: 46.33 },
            { n: "7", p: 43.30 },
            { n: "8", p: 40.49 },
            { n: "9", p: 37.89 },
            { n: "10", p: 35.20 }
        ];

        const dataB = [
            { n: "0 (Â∫ï‰ªì)", p: 65.20 },
            { n: "1", p: 65.20 },
            { n: "2", p: 59.70 },
            { n: "3", p: 54.65 },
            { n: "4", p: 50.06 },
            { n: "5", p: 45.84 },
            { n: "6", p: 41.98 },
            { n: "7", p: 38.41 },
            { n: "8", p: 35.15 },
            { n: "9", p: 32.16 },
            { n: "10", p: 29.50 }
        ];

        function formatNum(num, dec = 0) {
            return num.toLocaleString('en-US', { minimumFractionDigits: dec, maximumFractionDigits: dec });
        }

        async function fetchPrice() {
            const btn = document.querySelector('button[onclick="fetchPrice()"]');
            const originalText = btn.innerText;
            btn.innerText = "Ëé∑Âèñ‰∏≠...";
            
            try {
                // Attempt to fetch from a real source if available in the future.
                // Currently, Circle (CRCL) is Pre-IPO and has no public free API.
                // We strictly do NOT simulate random values here as per user request.
                
                // Example of real fetch structure (commented out until a valid endpoint exists):
                // const response = await fetch('https://api.example.com/crcl-price');
                // if (!response.ok) throw new Error("Network response was not ok");
                // const data = await response.json();
                // const newPrice = parseFloat(data.price);
                
                // Since no API is configured, we explicitly throw to trigger the default fallback.
                throw new Error("No public API configured");

            } catch (e) {
                console.log("Fetch failed or no API: Using default reference price.");
                
                // Fallback to default reference price as requested
                document.getElementById('currentMarketPrice').value = "65.20";
                recalc();
                
                btn.innerText = "‚ö†Ô∏è ‰ΩøÁî®ÈªòËÆ§ÂÄº";
                setTimeout(() => btn.innerText = originalText, 2000);
            }
        }

        function switchTab(t) {
            currentTab = t;
            document.getElementById('tab1').classList.toggle('active', t === 1);
            document.getElementById('tab2').classList.toggle('active', t === 2);
            document.getElementById('tableTitle').innerText = `ÊñπÊ°à ${t === 1 ? 'A' : 'B'} Ë°•‰ªìÊºîÂåñÁü©Èòµ`;
            recalc();
        }

        function recalc() {
            const baseInvest = parseFloat(document.getElementById('baseInvest').value);
            const stepInvest = parseFloat(document.getElementById('stepInvest').value);
            const currentCapBillion = parseFloat(document.getElementById('currentMarketCap').value);
            const currentMarketPrice = parseFloat(document.getElementById('currentMarketPrice').value);
            
            // Logic Update:
            // "153.56 ‰∫ø" in table usually means 15.356 Billion USD if unit is ‰∫øÁæéÂÖÉ.
            // Shares = 15,356,000,000 / 65.20 = 235,521,472.
            const impliedShares = 235521472; 

            document.getElementById('ref-shares').innerText = formatNum(impliedShares);
            document.getElementById('ref-mult').innerText = (5000 / 153.56).toFixed(1) + 'x'; 

            const activeData = currentTab === 1 ? dataA : dataB;
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';

            let cumInvest = 0;
            let cumShares = 0;
            
            // Real-time tracking
            let realizedShares = 0;
            let realizedCost = 0;

            activeData.forEach((row, idx) => {
                const tr = document.createElement('tr');
                
                // Logic for Execution Status
                const isExecuted = currentMarketPrice <= row.p;
                const isActivePrice = Math.abs(currentMarketPrice - row.p) < 0.5;

                if (isExecuted) tr.classList.add('executed-row');
                if (isActivePrice) tr.classList.add('active-row');
                
                let q = (idx === 0) ? Math.round(baseInvest / row.p) : Math.round(stepInvest / row.p);
                let roundInvest = (idx === 0) ? baseInvest : stepInvest;
                
                cumInvest += roundInvest;
                cumShares += q;

                if (isExecuted) {
                    realizedShares += q;
                    realizedCost += roundInvest;
                }

                const avgPrice = cumInvest / cumShares;
                
                // "Á¥ØËÆ°ÊàêÊú¨Â∏ÇÂÄº" = Implied Market Cap at Avg Cost
                const cumCostMV = (avgPrice * impliedShares) / 100000000; 

                // Valuation 5000 ‰∫ø (500B) and 7500 ‰∫ø (750B)
                const price500B = 500000000000 / impliedShares; // ~ $2122
                const price750B = 750000000000 / impliedShares; // ~ $3184
                
                const val500B = cumShares * price500B;
                const val750B = cumShares * price750B;

                tr.innerHTML = `
                    <td>
                        <div class="flex items-center gap-2">
                            ${row.n}
                            ${isExecuted ? '<span class="badge-green">EXECUTED</span>' : '<span class="badge-gray">PENDING</span>'}
                        </div>
                    </td>
                    <td class="text-value">${row.p.toFixed(2)}</td>
                    <td>${formatNum(q)}</td>
                    <td><span class="text-neutral-500">$</span>${formatNum(cumInvest)}</td>
                    <td>${formatNum(cumShares)}</td>
                    <td class="text-blue-400 font-bold">${avgPrice.toFixed(2)}</td>
                    <td>${cumCostMV.toFixed(2)}</td>
                    <td class="text-emerald-400 font-bold">${formatNum(val500B)}</td>
                    <td class="text-purple-400 font-bold">${formatNum(val750B)}</td>
                `;
                tbody.appendChild(tr);
            });

            // === Update Metrics (Top Row) ===
            // Logic Update: Show REALIZED (Executed) stats based on current price.
            
            const realAvg = realizedShares > 0 ? realizedCost / realizedShares : 0;
            
            // 0. Capital Deployed (New)
            document.getElementById('stat-deployed-capital').innerText = '$' + formatNum(realizedCost);

            // 1. Total Executed Shares
            document.getElementById('stat-total-shares').innerText = formatNum(realizedShares);
            document.getElementById('stat-total-cost').innerText = 'Plan Cap: $' + formatNum(cumInvest); // Changed to show Total Plan Cap for context
            
            // 2. Realized Avg Price
            document.getElementById('stat-avg-price').innerText = '$' + realAvg.toFixed(2);
            document.getElementById('stat-pnl').innerText = 'Avg Cost: $' + realAvg.toFixed(2);
            document.getElementById('stat-pnl').className = 'text-xs text-neutral-400 mt-1'; 

            // 3. Current Holdings Value at Target Valuation
            // Target Price per Share
            const targetPrice500 = 500000000000 / impliedShares;
            const targetPrice750 = 750000000000 / impliedShares;

            // Value of CURRENT holdings at target price
            const currentVal500 = realizedShares * targetPrice500;
            const currentVal750 = realizedShares * targetPrice750;

            // ROI based on REALIZED Avg Cost
            const roi500 = realAvg > 0 ? ((targetPrice500 - realAvg) / realAvg) * 100 : 0;
            const roi750 = realAvg > 0 ? ((targetPrice750 - realAvg) / realAvg) * 100 : 0;

            document.getElementById('stat-val-500b').innerText = '$' + (currentVal500 / 1000000).toFixed(1) + 'M';
            document.getElementById('stat-roi-500b').innerText = 'ROI: +' + roi500.toFixed(0) + '%';
            
            document.getElementById('stat-val-750b').innerText = '$' + (currentVal750 / 1000000).toFixed(1) + 'M';
            document.getElementById('stat-roi-750b').innerText = 'ROI: +' + roi750.toFixed(0) + '%';
        }

        recalc();
    </script>
</body>
</html>